@startuml

skinparam boundaryBackgroundColor #D5E8D4
skinparam controlBackgroundColor  #F8CECC
skinparam entityBackgroundColor   #DAE8FC

actor ユーザー
boundary Webページ
boundary 新規登録画面
control 入力チェック
control 認証コード送信
boundary 認証コード入力画面
boundary 登録完了画面

ユーザー -> Webページ : 「新規登録」を選択
Webページ -> 新規登録画面 : 新規登録画面を表示

ユーザー -> 新規登録画面 : ユーザID, パスワード, 学校名, 所属名, メールアドレス, 電話番号, 年齢を入力
新規登録画面 -> 入力チェック : 入力値チェック

alt ユーザID重複
    入力チェック -> 新規登録画面 : ユーザID重複エラー表示・再入力要求
    新規登録画面 -> ユーザー : エラー表示・再入力
else パスワード不正
    入力チェック -> 新規登録画面 : パスワード不正エラー表示・再入力要求
    新規登録画面 -> ユーザー : エラー表示・再入力
else メールアドレス不正
    入力チェック -> 新規登録画面 : メールアドレス不正エラー表示・再入力要求
    新規登録画面 -> ユーザー : エラー表示・再入力
else 電話番号不正
    入力チェック -> 新規登録画面 : 電話番号不正エラー表示・再入力要求
    新規登録画面 -> ユーザー : エラー表示・再入力
else 入力OK
    入力チェック -> 新規登録画面 : 入力OK
    ユーザー -> 新規登録画面 : 認証方法選択（メール or SMS）
    新規登録画面 -> 認証コード送信 : 認証コード送信依頼

    alt メールアドレス選択
        認証コード送信 -> ユーザー : メールアドレス宛に認証コード送信
    else SMS選択
        認証コード送信 -> ユーザー : 電話番号宛に認証コード送信
    end

    認証コード送信 -> 認証コード入力画面 : 認証コード入力画面を表示
    ユーザー -> 認証コード入力画面 : 認証コード入力

    alt 認証コード未入力で10分経過
        認証コード入力画面 -> ユーザー : 「認証コードの有効期限が切れました」表示
        
    else 認証コード入力
        認証コード入力画面 -> 登録完了画面 : 登録完了画面を表示
        登録完了画面 -> ユーザー : 完了通知
    end
end
@enduml